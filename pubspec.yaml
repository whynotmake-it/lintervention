name: lintervention
description: Effective lint rules used internally by whynotmake.it. Based on very_good_analysis.
version: 0.4.0+1
repository: https://github.com/whynotmake-it/lintervention
homepage: https://whynotmake.it
topics: [lints, analyzer, analysis]


environment:
  sdk: ^3.8.0

dependencies:
  very_good_analysis: ">=10.0.0 <11.0.0"

dev_dependencies:
  melos: ">=3.1.1 <7.2.0"


melos:
  useRootAsPackage: true

  commands:
    version:
      workspaceChangelog: false

  scripts:
    analyze:
      run: |
        dart analyze . --fatal-infos
      exec:
        # We are setting the concurrency to 1 because a higher concurrency can crash
        # the analysis server on low performance machines (like GitHub Actions).
        concurrency: 1
      description: |
        Run `dart analyze` in all packages.
        - Note: you can also rely on your IDEs Dart Analysis / Issues window.
    
    test:select:
      run: dart test
      exec:
        concurrency: 6
      packageFilters:
        dirExists: test
      description: Run `dart test` for selected packages.

    test:
      run: melos run test:select --no-select
      description: Run all dart tests in this project.

    coverage:select:
      run: |
        dart test --coverage=coverage && 
        dart pub global run coverage:format_coverage --lcov --in=coverage --out=coverage/lcov.info &&
        rm -rf coverage/test/
      exec:
        concurrency: 6
      packageFilters:
        dirExists: test
      description: Generate coverage for the selected package.

    coverage:
      run: melos run coverage:select --no-select
      description: Generate coverage for all packages.